<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>TÃ i chÃ­nh gia Ä‘Ã¬nh</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
 --primary:#2ecc71;
 --bg:#f2f4f7;
 --card:#fff;
 --text:#333;
}
body{
 font-family:-apple-system,BlinkMacSystemFont,sans-serif;
 background:var(--bg);
 margin:0;
 padding:12px;
 color:var(--text);
}
h1{text-align:center}
.card{
 background:var(--card);
 border-radius:18px;
 padding:16px;
 margin-bottom:14px;
 box-shadow:0 6px 16px rgba(0,0,0,.08);
}
input,select,button{
 width:100%;
 padding:12px;
 margin-top:6px;
 border-radius:12px;
 border:1px solid #ddd;
}
button{
 background:var(--primary);
 color:#fff;
 border:none;
 font-weight:600;
}
.item{display:flex;justify-content:space-between;margin-top:6px}
.small{font-size:13px;color:#777}
.warn{color:#e67e22;font-weight:600}
.good{color:#27ae60;font-weight:600}
.progress{
 background:#eee;border-radius:10px;height:10px;margin-top:4px
}
.progress div{
 height:100%;background:var(--primary)
}
</style>
</head>

<body>

<h1>ğŸ¦ TÃ i chÃ­nh gia Ä‘Ã¬nh</h1>

<!-- BUDGET -->
<div class="card">
<h3>ğŸ¯ NgÃ¢n sÃ¡ch theo danh má»¥c (thÃ¡ng)</h3>
<input id="bCat" placeholder="Danh má»¥c (Ä‚n uá»‘ngâ€¦)">
<input id="bVal" type="number" placeholder="NgÃ¢n sÃ¡ch">
<button onclick="addBudget()">LÆ°u ngÃ¢n sÃ¡ch</button>
<div id="budgetList"></div>
</div>

<!-- EXPENSE -->
<div class="card">
<h3>â• Chi tiÃªu</h3>
<input id="amount" type="number" placeholder="Sá»‘ tiá»n">
<select id="category"></select>
<button onclick="addExpense()">LÆ°u</button>
</div>

<!-- INVEST -->
<div class="card">
<h3>ğŸ“ˆ Theo dÃµi Ä‘áº§u tÆ°</h3>
<input id="invName" placeholder="TÃªn khoáº£n Ä‘áº§u tÆ°">
<select id="invType">
<option>An toÃ n</option>
<option>TÄƒng trÆ°á»Ÿng</option>
<option>DÃ i háº¡n</option>
</select>
<input id="invVal" type="number" placeholder="GiÃ¡ trá»‹ hiá»‡n táº¡i">
<button onclick="addInvestment()">ThÃªm</button>
<div id="invList"></div>
</div>

<!-- STRATEGY -->
<div class="card">
<h3>ğŸ§  ÄÃ¡nh giÃ¡ phÃ¢n bá»•</h3>
<div id="strategy"></div>
</div>

<script>
let budgets=JSON.parse(localStorage.getItem("budgets")||"[]");
let expenses=JSON.parse(localStorage.getItem("expenses")||"[]");
let investments=JSON.parse(localStorage.getItem("investments")||"[]");

function addBudget(){
 let c=bCat.value,v=+bVal.value;
 if(!c||!v)return;
 budgets.push({c,v});
 localStorage.setItem("budgets",JSON.stringify(budgets));
 bCat.value="";bVal.value="";
 render();
}

function addExpense(){
 let a=+amount.value;
 let c=category.value;
 if(!a)return;
 expenses.push({a,c});
 localStorage.setItem("expenses",JSON.stringify(expenses));
 amount.value="";
 render();
}

function addInvestment(){
 let v=+invVal.value;
 if(!v)return;
 investments.push({name:invName.value,type:invType.value,value:v});
 localStorage.setItem("investments",JSON.stringify(investments));
 invName.value="";invVal.value="";
 render();
}

function render(){
 // categories
 category.innerHTML="";
 budgets.forEach(b=>{
  let opt=document.createElement("option");
  opt.text=b.c;category.add(opt);
 });

 // budget view
 budgetList.innerHTML="";
 budgets.forEach(b=>{
  let spent=expenses.filter(e=>e.c==b.c).reduce((s,e)=>s+e.a,0);
  let p=Math.min(spent/b.v*100,100);
  budgetList.innerHTML+=`
   <div class="item">
    <span>${b.c}</span>
    <strong>${spent.toLocaleString()} / ${b.v.toLocaleString()}</strong>
   </div>
   <div class="progress"><div style="width:${p}%"></div></div>
   ${spent>b.v?'<p class="warn">âš ï¸ VÆ°á»£t ngÃ¢n sÃ¡ch</p>':''}
  `;
 });

 // investment strategy
 let sum={};
 investments.forEach(i=>sum[i.type]=(sum[i.type]||0)+i.value);
 let total=Object.values(sum).reduce((s,v)=>s+v,0);
 let html="";
 for(let k in sum){
  html+=`<div class="item"><span>${k}</span><strong>${Math.round(sum[k]/total*100)}%</strong></div>`;
 }
 if((sum["An toÃ n"]||0)/total<0.45){
  html+=`<p class="warn">âš ï¸ NÃªn tÄƒng nhÃ³m An toÃ n cho má»¥c tiÃªu mua BÄS</p>`;
 }else{
  html+=`<p class="good">âœ” PhÃ¢n bá»• phÃ¹ há»£p má»¥c tiÃªu 2â€“3 nÄƒm</p>`;
 }
 strategy.innerHTML=html;
}
render();
</script>

</body>
</html>
