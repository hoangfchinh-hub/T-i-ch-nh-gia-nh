<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>TÃ i chÃ­nh gia Ä‘Ã¬nh</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --primary:#4CAF50;
  --bg:#f2f4f7;
  --card:#fff;
  --text:#333;
}
body{
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  margin:0;
  padding:12px;
}
h1{text-align:center}
.card{
  background:var(--card);
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
}
input,select,button{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
  margin-top:6px;
}
button{
  background:var(--primary);
  color:#fff;
  border:none;
  font-weight:600;
}
.item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:6px;
}
.small{font-size:13px;color:#666}
.warn{color:#d35400;font-weight:600}
.good{color:#27ae60;font-weight:600}
.actions button{
  background:#eee;
  color:#333;
  padding:4px 8px;
  border-radius:6px;
  margin-left:4px;
}
</style>
</head>

<body>

<h1>ğŸ’° TÃ i chÃ­nh gia Ä‘Ã¬nh</h1>

<!-- THEME -->
<div class="card">
<h3>ğŸ¨ Giao diá»‡n</h3>
<select onchange="setTheme(this.value)">
<option value="#4CAF50">Xanh lÃ¡</option>
<option value="#3498db">Xanh dÆ°Æ¡ng</option>
<option value="#9b59b6">TÃ­m</option>
<option value="#e67e22">Cam</option>
</select>
</div>

<!-- ASSETS FIRST -->
<div class="card">
<h3>ğŸ¦ TÃ i sáº£n</h3>
<input id="assetName" placeholder="TÃªn tÃ i sáº£n">
<select id="assetType">
<option>An toÃ n</option>
<option>TÄƒng trÆ°á»Ÿng</option>
<option>Rá»§i ro</option>
</select>
<input id="assetValue" placeholder="GiÃ¡ trá»‹ (VND)" oninput="formatNumber(this)">
<button onclick="addAsset()">ThÃªm tÃ i sáº£n</button>
<div id="assetList"></div>
</div>

<!-- INCOME -->
<div class="card">
<h3>ğŸ’¼ Thu nháº­p thÃ¡ng</h3>
<input id="income" placeholder="Thu nháº­p (VND)" oninput="formatNumber(this)">
</div>

<!-- EXPENSE -->
<div class="card">
<h3>â• Chi tiÃªu</h3>
<input id="amount" placeholder="Sá»‘ tiá»n (VND)" oninput="formatNumber(this)">
<select id="category">
<option>Ä‚n uá»‘ng</option>
<option>Äi chá»£</option>
<option>NhÃ  á»Ÿ</option>
<option>GiÃ¡o dá»¥c</option>
<option>Di chuyá»ƒn</option>
<option>Du lá»‹ch</option>
<option>KhÃ¡c</option>
</select>
<button onclick="addExpense()">LÆ°u chi tiÃªu</button>
</div>

<div class="card">
<h3>ğŸ“Š Chi tiÃªu theo danh má»¥c</h3>
<canvas id="expenseChart"></canvas>
<div id="expenseList"></div>
</div>

<!-- STRATEGY -->
<div class="card">
<h3>ğŸ§  ÄÃ¡nh giÃ¡ chiáº¿n lÆ°á»£c</h3>
<div id="strategy"></div>
</div>

<script>
let expenses=JSON.parse(localStorage.getItem("expenses")||"[]");
let assets=JSON.parse(localStorage.getItem("assets")||"[]");
let income=+localStorage.getItem("income")||0;
document.getElementById("income").value=formatDisplay(income);

function formatNumber(el){
 let v=el.value.replace(/\D/g,"");
 el.value=formatDisplay(v);
}
function formatDisplay(n){
 return n?Number(n).toLocaleString("vi-VN"):"";
}
function getNumber(v){
 return +v.replace(/\D/g,"")||0;
}

function addExpense(){
 let a=getNumber(amount.value);
 if(!a)return;
 expenses.push({a,cat:category.value});
 localStorage.setItem("expenses",JSON.stringify(expenses));
 amount.value="";
 render();
}

function addAsset(){
 let v=getNumber(assetValue.value);
 if(!v)return;
 assets.push({name:assetName.value,type:assetType.value,value:v});
 localStorage.setItem("assets",JSON.stringify(assets));
 assetName.value="";assetValue.value="";
 render();
}

function deleteItem(arr,i,key){
 arr.splice(i,1);
 localStorage.setItem(key,JSON.stringify(arr));
 render();
}

function render(){
 localStorage.setItem("income",getNumber(income.value));
 renderAssets();
 renderExpenses();
 renderChart();
 renderStrategy();
}

function renderAssets(){
 assetList.innerHTML="";
 assets.forEach((a,i)=>{
  assetList.innerHTML+=`
  <div class="item">
   <span>${a.name} (${a.type})</span>
   <strong>${a.value.toLocaleString()}Ä‘</strong>
   <div class="actions">
    <button onclick="deleteItem(assets,${i},'assets')">âŒ</button>
   </div>
  </div>`;
 });
}

function renderExpenses(){
 expenseList.innerHTML="";
 expenses.slice(-8).reverse().forEach((e,i)=>{
  expenseList.innerHTML+=`
  <div class="item">
   <span>${e.cat}</span>
   <strong>${e.a.toLocaleString()}Ä‘</strong>
   <div class="actions">
    <button onclick="deleteItem(expenses,${expenses.length-1-i},'expenses')">âŒ</button>
   </div>
  </div>`;
 });
}

function renderChart(){
 let sum={};
 expenses.forEach(e=>sum[e.cat]=(sum[e.cat]||0)+e.a);
 if(window.chart)chart.destroy();
 chart=new Chart(expenseChart,{
  type:'pie',
  data:{labels:Object.keys(sum),
  datasets:[{data:Object.values(sum)}]}
 });
}

function renderStrategy(){
 let totalIncome=getNumber(income.value);
 let totalExpense=expenses.reduce((s,e)=>s+e.a,0);
 let saving=totalIncome-totalExpense;
 let html=`
 <div class="item"><span>Thu nháº­p</span><strong>${totalIncome.toLocaleString()}Ä‘</strong></div>
 <div class="item"><span>Chi tiÃªu</span><strong>${totalExpense.toLocaleString()}Ä‘</strong></div>
 <div class="item"><span>Tiáº¿t kiá»‡m</span><strong>${saving.toLocaleString()}Ä‘</strong></div>`;
 if(saving<=0) html+=`<p class="warn">âš ï¸ Äang chi vÆ°á»£t thu, chÆ°a phÃ¹ há»£p Ä‘áº§u tÆ°</p>`;
 else if(saving/totalIncome<0.2) html+=`<p class="warn">âš ï¸ Tá»· lá»‡ tiáº¿t kiá»‡m tháº¥p cho má»¥c tiÃªu mua BÄS</p>`;
 else html+=`<p class="good">âœ” DÃ²ng tiá»n tá»‘t cho má»¥c tiÃªu 2â€“3 nÄƒm</p>`;
 strategy.innerHTML=html;
}

render();
</script>

</body>
</html>
